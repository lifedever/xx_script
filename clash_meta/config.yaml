#---------------------------------------------------#
## Clash Meta é…ç½®æ–‡ä»¶
## é…ç½®æ–‡ä»¶éœ€è¦æ”¾ç½®åœ¨ $HOME/.config/clash.meta/*.yaml
##
## å‚è€ƒæ–‡æ¡£ï¼š
## Clash Meta wiki  https://wiki.metacubex.one/config/
#---------------------------------------------------#

# åŸºç¡€é…ç½®
mixed-port: 7891
allow-lan: true
bind-address: '*'
mode: rule
log-level: info
ipv6: false

# å¤–éƒ¨æ§åˆ¶
external-controller: 127.0.0.1:9090
# secret: "your-password"  # å¯é€‰ï¼šè®¾ç½®è®¿é—®å¯†ç 

# TUN æ¨¡å¼ - æ¥ç®¡ç³»ç»Ÿæ‰€æœ‰æµé‡
tun:
  enable: true
  stack: system
  auto-route: true
  auto-detect-interface: true
  dns-hijack:
    - any:53
    - tcp://any:53

# DNS é…ç½®
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  prefer-h3: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - '*.lan'
    - localhost.ptlogin2.qq.com
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - '+.msftconnecttest.com'
    - '+.msftncsi.com'
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  # å›½å¤– DNSï¼Œç”¨äºè§£æå›½å¤–åŸŸå
  fallback:
    - https://dns.cloudflare.com/dns-query
    - https://dns.google/dns-query
    - tls://8.8.8.8:853
  # fallback è¿‡æ»¤å™¨ï¼šå‘½ä¸­æ¡ä»¶æ—¶ä½¿ç”¨ fallback DNS
  fallback-filter:
    geoip: true
    geoip-code: CN
    geosite:
      - gfw
    ipcidr:
      - 240.0.0.0/4
    domain:
      - '+.google.com'
      - '+.youtube.com'
      - '+.notion.so'
      - '+.notion.com'
      - '+.github.com'
      - '+.githubusercontent.com'

# GEO æ•°æ®
geodata-mode: true
geox-url:
  geoip: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geoip.dat"
  geosite: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/geosite.dat"
  mmdb: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@release/country.mmdb"

#---------------------------------------------------#
# ä»£ç†æä¾›è€… - ä»è®¢é˜…é“¾æ¥è·å–èŠ‚ç‚¹
# è¯·å°† YOUR_SUBSCRIPTION_URL æ›¿æ¢ä¸ºä½ çš„å®é™…è®¢é˜…é“¾æ¥
#---------------------------------------------------#
proxy-providers:
  # è‰¯å¿ƒäº‘
  liangxin:
    type: http
    url: "https://liangxin.xyz/api/v1/liangxin?OwO=c6c3adf6b73e8f32b0375346fe7224df"
    interval: 3600
    path: ./proxies/liangxin.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

  # Hnekoäº‘
  hneko:
    type: http
    url: "https://study.small1999.sbs/study/xuexi/v999/hneko?token=3191030f3727b2d1c0842d4a1365314c"
    interval: 3600
    path: ./proxies/hneko.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

#---------------------------------------------------#
# ä»£ç†ç»„é…ç½®
#---------------------------------------------------#
proxy-groups:
  # ä¸»ä»£ç†é€‰æ‹©
  - name: "ğŸš€ ä»£ç†"
    type: select
    proxies:
      - "âš¡ è‡ªåŠ¨"
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯"
      - "ğŸ‡¨ğŸ‡³ å°æ¹¾"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
      - "ğŸ‡°ğŸ‡· éŸ©å›½"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½"
      - "ğŸŒ å…¶ä»–å›½å®¶"
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Static.png"

  # è‡ªåŠ¨é€‰æ‹©æœ€å¿«èŠ‚ç‚¹
  - name: "âš¡ è‡ªåŠ¨"
    type: url-test
    use:
      - liangxin
      - hneko
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Urltest.png"

  # AI æœåŠ¡ä¸“ç”¨
  - name: "ğŸ¤– AI"
    type: select
    proxies:
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
      - "ğŸ‡°ğŸ‡· éŸ©å›½"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½"
      - "ğŸŒ å…¶ä»–å›½å®¶"
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/OpenAI.png"

  # Telegram ä¸“ç”¨
  - name: "âœˆï¸ ç”µæŠ¥"
    type: select
    proxies:
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯"
      - "ğŸ‡¨ğŸ‡³ å°æ¹¾"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
      - "ğŸ‡°ğŸ‡· éŸ©å›½"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½"
      - "ğŸŒ å…¶ä»–å›½å®¶"
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Telegram.png"

  # Google æœåŠ¡ä¸“ç”¨
  - name: "ğŸ” è°·æ­Œ"
    type: select
    proxies:
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯"
      - "ğŸ‡¨ğŸ‡³ å°æ¹¾"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
      - "ğŸ‡°ğŸ‡· éŸ©å›½"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½"
      - "ğŸŒ å…¶ä»–å›½å®¶"
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Google.png"

  # Microsoft æœåŠ¡ä¸“ç”¨
  - name: "ğŸªŸ å¾®è½¯"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯"
      - "ğŸ‡¨ğŸ‡³ å°æ¹¾"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
      - "ğŸ‡°ğŸ‡· éŸ©å›½"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½"
      - "ğŸŒ å…¶ä»–å›½å®¶"
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Microsoft.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - é¦™æ¸¯
  - name: "ğŸ‡­ğŸ‡° é¦™æ¸¯"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "(?i)é¦™æ¸¯|Hong Kong|HK|ğŸ‡­ğŸ‡°"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/HK.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - å°æ¹¾
  - name: "ğŸ‡¨ğŸ‡³ å°æ¹¾"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "(?i)å°æ¹¾|Taiwan|TW|ğŸ‡¹ğŸ‡¼"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/TW.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - æ–°åŠ å¡
  - name: "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "(?i)æ–°åŠ å¡|Singapore|ğŸ‡¸ğŸ‡¬"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/SG.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - æ—¥æœ¬
  - name: "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "(?i)æ—¥æœ¬|Japan|ğŸ‡¯ğŸ‡µ"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/JP.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - éŸ©å›½
  - name: "ğŸ‡°ğŸ‡· éŸ©å›½"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "(?i)éŸ©å›½|Korea|KR|ğŸ‡°ğŸ‡·"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/KR.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - ç¾å›½
  - name: "ğŸ‡ºğŸ‡¸ ç¾å›½"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "(?i)ç¾å›½|USA|ğŸ‡ºğŸ‡¸"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/US.png"

  # åœ°åŒºèŠ‚ç‚¹ç»„ - å…¶ä»–å›½å®¶
  - name: "ğŸŒ å…¶ä»–å›½å®¶"
    type: url-test
    use:
      - liangxin
      - hneko
    filter: "^(?!.*(å°æ¹¾|Taiwan|TW|é¦™æ¸¯|Hong Kong|HK|ğŸ‡­ğŸ‡°|æ–°åŠ å¡|Singapore|ğŸ‡¸ğŸ‡¬|æ—¥æœ¬|Japan|ğŸ‡¯ğŸ‡µ|ç¾å›½|USA|ğŸ‡ºğŸ‡¸|éŸ©å›½|Korea|KR|ğŸ‡°ğŸ‡·)).*$"
    exclude-filter: "(?i)GB|Traffic|Expire|Premium|é¢‘é“|è®¢é˜…|ISP|æµé‡|åˆ°æœŸ|é‡ç½®"
    url: http://www.gstatic.com/generate_204
    interval: 3600
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/UN.png"

  # å…œåº•åˆ†ç»„
  - name: "ğŸŸ å…œåº•"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸš€ ä»£ç†"
      - "âš¡ è‡ªåŠ¨"
      - "ğŸ‡­ğŸ‡° é¦™æ¸¯"
      - "ğŸ‡¨ğŸ‡³ å°æ¹¾"
      - "ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡"
      - "ğŸ‡¯ğŸ‡µ æ—¥æœ¬"
      - "ğŸ‡°ğŸ‡· éŸ©å›½"
      - "ğŸ‡ºğŸ‡¸ ç¾å›½"
      - "ğŸŒ å…¶ä»–å›½å®¶"
    icon: "https://testingcf.jsdelivr.net/gh/Orz-3/mini@master/Color/Final.png"

#---------------------------------------------------#
# è§„åˆ™æä¾›è€… - ä»è¿œç¨‹è·å–è§„åˆ™é›†
#---------------------------------------------------#
rule-providers:
  # è‡ªå®šä¹‰è§„åˆ™
  my_private:
    type: http
    url: "https://raw.githubusercontent.com/lifedever/xx_script/refs/heads/main/clash/rules/Private.yaml"
    path: ./ruleset/my_private.yaml
    behavior: domain
    interval: 86400
    format: yaml

  my_ai:
    type: http
    url: "https://raw.githubusercontent.com/lifedever/xx_script/refs/heads/main/clash/rules/Ai.yaml"
    path: ./ruleset/my_ai.yaml
    behavior: classical
    interval: 86400
    format: yaml

  my_proxy:
    type: http
    url: "https://raw.githubusercontent.com/lifedever/xx_script/refs/heads/main/clash/rules/Proxy.yaml"
    path: ./ruleset/my_proxy.yaml
    behavior: classical
    interval: 86400
    format: yaml

  # ç§æœ‰ç½‘ç»œ
  private:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.yaml"
    path: ./ruleset/private.yaml
    behavior: domain
    interval: 86400
    format: yaml

  # Apple æœåŠ¡
  apple:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple.yaml"
    path: ./ruleset/apple.yaml
    behavior: classical
    interval: 86400
    format: yaml

  # AI æœåŠ¡è§„åˆ™
  bing:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Bing/Bing.yaml"
    path: ./ruleset/bing.yaml
    behavior: classical
    interval: 86400
    format: yaml

  copilot:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Copilot/Copilot.yaml"
    path: ./ruleset/copilot.yaml
    behavior: classical
    interval: 86400
    format: yaml

  claude:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml"
    path: ./ruleset/claude.yaml
    behavior: classical
    interval: 86400
    format: yaml

  bard:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BardAI/BardAI.yaml"
    path: ./ruleset/bard.yaml
    behavior: classical
    interval: 86400
    format: yaml

  openai:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml"
    path: ./ruleset/openai.yaml
    behavior: classical
    interval: 86400
    format: yaml

  # Telegram
  telegram_domain:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.yaml"
    path: ./ruleset/telegram_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml

  telegram_ip:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.yaml"
    path: ./ruleset/telegram_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml

  # Google
  google_domain:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google.yaml"
    path: ./ruleset/google_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml

  google_ip:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.yaml"
    path: ./ruleset/google_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml

  # Microsoft
  microsoft_domain:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/microsoft.yaml"
    path: ./ruleset/microsoft_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml

  microsoft:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Microsoft/Microsoft.yaml"
    path: ./ruleset/microsoft.yaml
    behavior: classical
    interval: 86400
    format: yaml

  # Steam
  steam:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Steam/Steam.yaml"
    path: ./ruleset/steam.yaml
    behavior: classical
    interval: 86400
    format: yaml

  # Cloudflare
  cloudflare:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Cloudflare/Cloudflare.yaml"
    path: ./ruleset/cloudflare.yaml
    behavior: classical
    interval: 86400
    format: yaml

  # éä¸­å›½åŸŸå
  geolocation-!cn:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/geolocation-!cn.yaml"
    path: ./ruleset/geolocation-!cn.yaml
    behavior: domain
    interval: 86400
    format: yaml

  # ä¸­å›½åŸŸåå’ŒIP
  cn_domain:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.yaml"
    path: ./ruleset/cn_domain.yaml
    behavior: domain
    interval: 86400
    format: yaml

  cn_ip:
    type: http
    url: "https://testingcf.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.yaml"
    path: ./ruleset/cn_ip.yaml
    behavior: ipcidr
    interval: 86400
    format: yaml

#---------------------------------------------------#
# è·¯ç”±è§„åˆ™
#---------------------------------------------------#
rules:
  # Notion ç›´æ¥èµ°ä»£ç†ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
  - DOMAIN-SUFFIX,notion.so,ğŸš€ ä»£ç†
  - DOMAIN-SUFFIX,notion.com,ğŸš€ ä»£ç†
  - DOMAIN-SUFFIX,notion-static.com,ğŸš€ ä»£ç†

  # ç§æœ‰ç½‘ç»œç›´è¿
  - RULE-SET,my_private,DIRECT
  - RULE-SET,private,DIRECT

  # Apple ç›´è¿
  - RULE-SET,apple,DIRECT

  # AI æœåŠ¡
  - RULE-SET,my_ai,ğŸ¤– AI
  - RULE-SET,bing,ğŸ¤– AI
  - RULE-SET,copilot,ğŸ¤– AI
  - RULE-SET,bard,ğŸ¤– AI
  - RULE-SET,openai,ğŸ¤– AI
  - RULE-SET,claude,ğŸ¤– AI

  # è‡ªå®šä¹‰ä»£ç†
  - RULE-SET,my_proxy,ğŸš€ ä»£ç†

  # Steam / Cloudflare
  - RULE-SET,steam,ğŸš€ ä»£ç†
  - RULE-SET,cloudflare,ğŸš€ ä»£ç†

  # Telegram
  - RULE-SET,telegram_domain,âœˆï¸ ç”µæŠ¥
  - RULE-SET,telegram_ip,âœˆï¸ ç”µæŠ¥

  # Google
  - RULE-SET,google_domain,ğŸ” è°·æ­Œ
  - RULE-SET,google_ip,ğŸ” è°·æ­Œ

  # Microsoft
  - RULE-SET,microsoft_domain,ğŸªŸ å¾®è½¯
  - RULE-SET,microsoft,ğŸªŸ å¾®è½¯

  # éä¸­å›½åŸŸåèµ°ä»£ç†
  - RULE-SET,geolocation-!cn,ğŸš€ ä»£ç†

  # ä¸­å›½åŸŸåå’ŒIPç›´è¿
  - RULE-SET,cn_domain,DIRECT
  - RULE-SET,cn_ip,DIRECT

  # å…œåº•è§„åˆ™
  - MATCH,ğŸŸ å…œåº•
